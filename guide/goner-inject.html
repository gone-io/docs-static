<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Injection Methods Supported by Gone | Gone Document</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/assets/img/logo.png">
    <script type="text/javascript">
            if (location.hostname != 'localhost'){
                var _hmt = _hmt || [];
                (function() {
                  var hm = document.createElement("script");
                  hm.src = "https://hm.baidu.com/hm.js?ed9e5a48d8eeb5e6b55a0de9cb8f6486";
                  var s = document.getElementsByTagName("script")[0]; 
                  s.parentNode.insertBefore(hm, s);
                })();
                if(location.pathname == '/my-github'){
                    location.href='https://github.com/gone-io/gone'
                }
            }
            </script>
    <meta name="description" content="Gone is a lightweight dependency injection framework based on Golang, integrating many open-source tools such as Gin, XOrm, Logrus, etc., to provide convenient web development.">
    <link rel="preload" href="/assets/css/0.styles.ef76fb7a.css" as="style"><link rel="preload" href="/assets/js/app.adb83b8a.js" as="script"><link rel="preload" href="/assets/js/2.f18e2b4c.js" as="script"><link rel="preload" href="/assets/js/1.83b28654.js" as="script"><link rel="preload" href="/assets/js/19.06ac8f8c.js" as="script"><link rel="prefetch" href="/assets/js/10.0ee1033c.js"><link rel="prefetch" href="/assets/js/11.1b93f309.js"><link rel="prefetch" href="/assets/js/12.dfb21252.js"><link rel="prefetch" href="/assets/js/13.ba2e5946.js"><link rel="prefetch" href="/assets/js/14.dc48dc13.js"><link rel="prefetch" href="/assets/js/15.f5494b4f.js"><link rel="prefetch" href="/assets/js/16.0eb527a0.js"><link rel="prefetch" href="/assets/js/17.b17c6981.js"><link rel="prefetch" href="/assets/js/18.1208b728.js"><link rel="prefetch" href="/assets/js/20.47570d87.js"><link rel="prefetch" href="/assets/js/21.fd8de9f3.js"><link rel="prefetch" href="/assets/js/22.5fdea428.js"><link rel="prefetch" href="/assets/js/23.06f1e408.js"><link rel="prefetch" href="/assets/js/24.41c07631.js"><link rel="prefetch" href="/assets/js/25.24cbbbcb.js"><link rel="prefetch" href="/assets/js/26.f8d97083.js"><link rel="prefetch" href="/assets/js/27.f64ac172.js"><link rel="prefetch" href="/assets/js/28.be16afe1.js"><link rel="prefetch" href="/assets/js/29.dbd850a7.js"><link rel="prefetch" href="/assets/js/3.c0437673.js"><link rel="prefetch" href="/assets/js/30.baecc1e9.js"><link rel="prefetch" href="/assets/js/31.a1ab2eaf.js"><link rel="prefetch" href="/assets/js/32.8385c5d7.js"><link rel="prefetch" href="/assets/js/33.12765077.js"><link rel="prefetch" href="/assets/js/34.ad7ac11d.js"><link rel="prefetch" href="/assets/js/35.ecaa3b68.js"><link rel="prefetch" href="/assets/js/36.934ac302.js"><link rel="prefetch" href="/assets/js/37.7b0d48fe.js"><link rel="prefetch" href="/assets/js/38.bb9b17c3.js"><link rel="prefetch" href="/assets/js/39.68305519.js"><link rel="prefetch" href="/assets/js/4.29a103ea.js"><link rel="prefetch" href="/assets/js/40.e26fed9c.js"><link rel="prefetch" href="/assets/js/41.68ef0249.js"><link rel="prefetch" href="/assets/js/42.7fcaf71c.js"><link rel="prefetch" href="/assets/js/43.f3c2fa4d.js"><link rel="prefetch" href="/assets/js/44.8524cfde.js"><link rel="prefetch" href="/assets/js/45.97b2f9d2.js"><link rel="prefetch" href="/assets/js/46.76b7283f.js"><link rel="prefetch" href="/assets/js/47.bdbe01ea.js"><link rel="prefetch" href="/assets/js/48.40ec4a30.js"><link rel="prefetch" href="/assets/js/49.69f964f6.js"><link rel="prefetch" href="/assets/js/5.4fad613e.js"><link rel="prefetch" href="/assets/js/50.7d94d26a.js"><link rel="prefetch" href="/assets/js/51.43361106.js"><link rel="prefetch" href="/assets/js/52.4bef3c38.js"><link rel="prefetch" href="/assets/js/53.679654a9.js"><link rel="prefetch" href="/assets/js/54.07605bb1.js"><link rel="prefetch" href="/assets/js/55.63d4cee7.js"><link rel="prefetch" href="/assets/js/56.d40df3c1.js"><link rel="prefetch" href="/assets/js/57.452531b1.js"><link rel="prefetch" href="/assets/js/58.441570ad.js"><link rel="prefetch" href="/assets/js/59.ba51f218.js"><link rel="prefetch" href="/assets/js/6.43db7c1f.js"><link rel="prefetch" href="/assets/js/60.93c1e110.js"><link rel="prefetch" href="/assets/js/61.8ec5ae6b.js"><link rel="prefetch" href="/assets/js/62.f775b5e1.js"><link rel="prefetch" href="/assets/js/63.3b9bbdc9.js"><link rel="prefetch" href="/assets/js/64.f89f6380.js"><link rel="prefetch" href="/assets/js/65.688b0132.js"><link rel="prefetch" href="/assets/js/7.94af19b6.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.cf079a49.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ef76fb7a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="Gone Document" class="logo"> <span class="site-name can-hide">Gone Document</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Quick Start" class="dropdown-title"><span class="title">Quick Start</span> <span class="arrow down"></span></button> <button type="button" aria-label="Quick Start" class="mobile-dropdown-title"><span class="title">Quick Start</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/quick-start/simple.html" class="nav-link">
  Creating a Simple Web Project
</a></li><li class="dropdown-item"><!----> <a href="/quick-start/mysql.html" class="nav-link">
  Web + MySQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Development Guide" class="dropdown-title"><span class="title">Development Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Development Guide" class="mobile-dropdown-title"><span class="title">Development Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/core-concept.html" class="nav-link">
  Core Concepts of Gone
</a></li><li class="dropdown-item"><!----> <a href="/guide/gone-and-inject.html" class="nav-link">
  Goner and Dependency Injection
</a></li><li class="dropdown-item"><!----> <a href="/guide/goner-inject.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Injection Methods Supported by Gone
</a></li><li class="dropdown-item"><!----> <a href="/guide/inner-goner.html" class="nav-link">
  How to Gracefully Use Built-in Goners?
</a></li><li class="dropdown-item"><!----> <a href="/guide/config.html" class="nav-link">
  Configuring with Built-in Goners Support
</a></li><li class="dropdown-item"><!----> <a href="/guide/xorm.html" class="nav-link">
  Performing database operations
</a></li><li class="dropdown-item"><!----> <a href="/guide/hooks.html" class="nav-link">
  Gone's Hook Functions
</a></li><li class="dropdown-item"><!----> <a href="/guide/logrus.html" class="nav-link">
  Logging Output
</a></li><li class="dropdown-item"><!----> <a href="/guide/tracer.html" class="nav-link">
  Trace Log with traceId
</a></li><li class="dropdown-item"><!----> <a href="/guide/auto-gen-priest.html" class="nav-link">
  Auto-generate Priest
</a></li><li class="dropdown-item"><!----> <a href="/guide/redis.html" class="nav-link">
  Using Redis for Distributed Locking and Caching
</a></li><li class="dropdown-item"><!----> <a href="/guide/unit-test.html" class="nav-link">
  Unit Testing
</a></li></ul></div></div><div class="nav-item"><a href="/references/" class="nav-link">
  References
</a></div><div class="nav-item"><a href="/goners/" class="nav-link">
  Goners
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/guide/goner-inject.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/guide/goner-inject.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <a href="https://github.com/gone-io/gone" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Quick Start" class="dropdown-title"><span class="title">Quick Start</span> <span class="arrow down"></span></button> <button type="button" aria-label="Quick Start" class="mobile-dropdown-title"><span class="title">Quick Start</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/quick-start/simple.html" class="nav-link">
  Creating a Simple Web Project
</a></li><li class="dropdown-item"><!----> <a href="/quick-start/mysql.html" class="nav-link">
  Web + MySQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Development Guide" class="dropdown-title"><span class="title">Development Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Development Guide" class="mobile-dropdown-title"><span class="title">Development Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/core-concept.html" class="nav-link">
  Core Concepts of Gone
</a></li><li class="dropdown-item"><!----> <a href="/guide/gone-and-inject.html" class="nav-link">
  Goner and Dependency Injection
</a></li><li class="dropdown-item"><!----> <a href="/guide/goner-inject.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Injection Methods Supported by Gone
</a></li><li class="dropdown-item"><!----> <a href="/guide/inner-goner.html" class="nav-link">
  How to Gracefully Use Built-in Goners?
</a></li><li class="dropdown-item"><!----> <a href="/guide/config.html" class="nav-link">
  Configuring with Built-in Goners Support
</a></li><li class="dropdown-item"><!----> <a href="/guide/xorm.html" class="nav-link">
  Performing database operations
</a></li><li class="dropdown-item"><!----> <a href="/guide/hooks.html" class="nav-link">
  Gone's Hook Functions
</a></li><li class="dropdown-item"><!----> <a href="/guide/logrus.html" class="nav-link">
  Logging Output
</a></li><li class="dropdown-item"><!----> <a href="/guide/tracer.html" class="nav-link">
  Trace Log with traceId
</a></li><li class="dropdown-item"><!----> <a href="/guide/auto-gen-priest.html" class="nav-link">
  Auto-generate Priest
</a></li><li class="dropdown-item"><!----> <a href="/guide/redis.html" class="nav-link">
  Using Redis for Distributed Locking and Caching
</a></li><li class="dropdown-item"><!----> <a href="/guide/unit-test.html" class="nav-link">
  Unit Testing
</a></li></ul></div></div><div class="nav-item"><a href="/references/" class="nav-link">
  References
</a></div><div class="nav-item"><a href="/goners/" class="nav-link">
  Goners
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/guide/goner-inject.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/guide/goner-inject.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <a href="https://github.com/gone-io/gone" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Injection Methods Supported by Gone</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/goner-inject.html#public-property-injection-vs-private-property-injection" class="sidebar-link">Public Property Injection vs Private Property Injection</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guide/goner-inject.html#anonymous-injection-vs-named-injection" class="sidebar-link">Anonymous Injection vs Named Injection</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#anonymous-burial-and-named-burial" class="sidebar-link">Anonymous Burial and Named Burial</a></li><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#anonymous-injection" class="sidebar-link">Anonymous Injection</a></li><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#named-injection" class="sidebar-link">Named Injection</a></li></ul></li><li><a href="/guide/goner-inject.html#supported-injection-property-types" class="sidebar-link">Supported Injection Property Types</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#_1-pointer-types" class="sidebar-link">1. Pointer Types</a></li><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#_2-value-types" class="sidebar-link">2. Value Types</a></li><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#_3-interface-types" class="sidebar-link">3. Interface Types</a></li><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#_4-slice-types" class="sidebar-link">4. Slice Types</a></li><li class="sidebar-sub-header"><a href="/guide/goner-inject.html#_5-map-types" class="sidebar-link">5. Map Types</a></li></ul></li><li><a href="/guide/goner-inject.html#pointer-injection-vs-interface-injection" class="sidebar-link">Pointer Injection vs Interface Injection</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guide/goner-inject.html#slice-injection-vs-map-injection" class="sidebar-link">Slice Injection vs Map Injection</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="injection-methods-supported-by-gone"><a href="#injection-methods-supported-by-gone" class="header-anchor">#</a> Injection Methods Supported by Gone</h1> <p></p><div class="table-of-contents"><ul><li><a href="#public-property-injection-vs-private-property-injection">Public Property Injection vs Private Property Injection</a></li><li><a href="#anonymous-injection-vs-named-injection">Anonymous Injection vs Named Injection</a><ul><li><a href="#anonymous-burial-and-named-burial">Anonymous Burial and Named Burial</a></li><li><a href="#anonymous-injection">Anonymous Injection</a></li><li><a href="#named-injection">Named Injection</a></li></ul></li><li><a href="#supported-injection-property-types">Supported Injection Property Types</a><ul><li><a href="#_1-pointer-types">1. Pointer Types</a></li><li><a href="#_2-value-types">2. Value Types</a></li><li><a href="#_3-interface-types">3. Interface Types</a></li><li><a href="#_4-slice-types">4. Slice Types</a></li><li><a href="#_5-map-types">5. Map Types</a></li></ul></li><li><a href="#pointer-injection-vs-interface-injection">Pointer Injection vs Interface Injection</a></li><li><a href="#slice-injection-vs-map-injection">Slice Injection vs Map Injection</a></li></ul></div><p></p> <h2 id="public-property-injection-vs-private-property-injection"><a href="#public-property-injection-vs-private-property-injection" class="header-anchor">#</a> Public Property Injection vs Private Property Injection</h2> <p>In Gone, both public property injection and private property injection are supported. Dependency injection typically restricts the &quot;objects&quot; to be injected to be used only within the module. Following the &quot;open-closed&quot; principle, I recommend using private property injection.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Recommendation: Private Property Injection</p></div> <p>For example:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> demo
<span class="token keyword">import</span> <span class="token string">&quot;github.com/gone-io/gone&quot;</span>
<span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
	Name      <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
    seller  <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;seller&quot;`</span>  <span class="token comment">// lowercase first letter indicates private property injection, accessible only within the package</span>
    Manager <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;manager&quot;`</span> <span class="token comment">// uppercase first letter indicates public property injection, accessible without restrictions</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="anonymous-injection-vs-named-injection"><a href="#anonymous-injection-vs-named-injection" class="header-anchor">#</a> Anonymous Injection vs Named Injection</h2> <h3 id="anonymous-burial-and-named-burial"><a href="#anonymous-burial-and-named-burial" class="header-anchor">#</a> Anonymous Burial and Named Burial</h3> <p>To inject a Goner, it must first be loaded into the system. In Gone, this process is termed as <strong>burial</strong>, done in the <strong>Priest</strong> function by invoking the <code>cemetery.Bury</code> function to &quot;bury&quot; the reference of the Goner into the <strong>cemetery</strong>. When burying, if no GonerId is specified, it's an <strong>anonymous burial</strong>; if specified, it's a <strong>named burial</strong>.</p> <p>The complete definition of the <strong><code>Cemetery.Bury</code></strong> function is as follows: <strong><code>Bury(Goner, ...GonerId) Cemetery</code></strong>. This definition is designed with two considerations:</p> <ol><li>It supports <strong>named burials</strong>, where the second parameter is optional, allowing passing a string as the <strong>Goner</strong>'s <strong>ID</strong> (<strong>GonerId</strong>).</li> <li>It enables method chaining for the Bury function.</li></ol> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Priest</span><span class="token punctuation">(</span>cemetery gone<span class="token punctuation">.</span>Cemetery<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	cemetery<span class="token punctuation">.</span>
		<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AGoner<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Injected Goner1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token comment">// named burial for the first AGoner, ID=A1</span>
		<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AGoner<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Injected Goner2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;A2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token comment">// named burial for the second AGoner, ID=A2</span>
		<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>BGoner<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// anonymous burial</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>In anonymous burial, if there exist multiple compatible types of <strong>Goner</strong>, only one of them will be injected, typically the first one revived. This may lead to undefined behavior. For example:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;github.com/gone-io/gone&quot;</span>
<span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
	Name      <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
	seller <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// anonymous injection, if multiple Workers exist, only one will be injected, typically the first one</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>cemetery gone<span class="token punctuation">.</span>Cemetery<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
		cemetery<span class="token punctuation">.</span><span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Boss<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		cemetery<span class="token punctuation">.</span><span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Worker<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		cemetery<span class="token punctuation">.</span><span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Worker<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="anonymous-injection"><a href="#anonymous-injection" class="header-anchor">#</a> Anonymous Injection</h3> <p>When injecting without specifying the Goner's GonerId, it's termed as anonymous injection, indicated by the injection tag <code>gone:&quot;*&quot;</code>.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
    seller <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// anonymous injection</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>In anonymous injection, if there are multiple compatible types of <strong>Goner</strong>, only one will be injected, typically the first one revived. This may lead to undefined behavior. For example:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;github.com/gone-io/gone&quot;</span>
<span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
	Name      <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
	seller <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// anonymous injection, if multiple Workers exist, only one will be injected, typically the first one</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>cemetery gone<span class="token punctuation">.</span>Cemetery<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
		cemetery<span class="token punctuation">.</span><span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Boss<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		cemetery<span class="token punctuation">.</span><span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Worker<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		cemetery<span class="token punctuation">.</span><span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Worker<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="named-injection"><a href="#named-injection" class="header-anchor">#</a> Named Injection</h3> <p>When injecting with a specified GonerId, it's termed as named injection. Named injection accurately injects a Goner based on its name, which is useful in practical development. It's essential to ensure that a Goner with the corresponding GonerId is buried in the cemetery.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag <span class="token comment">// Goner flag, embedding `gone.Flag` anonymously indicates that this structure is a Goner</span>
    Manager <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;manager&quot;`</span> <span class="token comment">// named injection</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="supported-injection-property-types"><a href="#supported-injection-property-types" class="header-anchor">#</a> Supported Injection Property Types</h2> <h3 id="_1-pointer-types"><a href="#_1-pointer-types" class="header-anchor">#</a> 1. Pointer Types</h3> <p>When the injected Goner property is a pointer, it's termed as <strong>pointer injection</strong>.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag
    seller <span class="token operator">*</span>Worker <span class="token string">`gone:&quot;seller&quot;`</span> <span class="token comment">// pointer type</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-value-types"><a href="#_2-value-types" class="header-anchor">#</a> 2. Value Types</h3> <p>When the injected Goner property is a value type, it's termed as <strong>value injection</strong>.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag
    seller Worker <span class="token string">`gone:&quot;seller&quot;`</span> <span class="token comment">// value type</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>In Go, value types are passed by copy, meaning that when using value injection, a new &quot;object&quot; is created, and the old and new objects are independent in memory. This may lead to unexpected results. For example:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> BGoner <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	a1 AGoner <span class="token string">`gone:&quot;A1&quot;`</span> <span class="token comment">// value injection</span>
	a2 AGoner <span class="token string">`gone:&quot;A1&quot;`</span> <span class="token comment">// value injection</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>g <span class="token operator">*</span>BGoner<span class="token punctuation">)</span> <span class="token function">AfterRevive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gone<span class="token punctuation">.</span>AfterReviveError <span class="token punctuation">{</span>
	g<span class="token punctuation">.</span>a1<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;dapeng&quot;</span>
	g<span class="token punctuation">.</span>a2<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;wang&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a1 is eq a2: %v&quot;</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>a1 <span class="token operator">==</span> g<span class="token punctuation">.</span>a2<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the above code, the printed result will be <code>false</code>.</p></div> <h3 id="_3-interface-types"><a href="#_3-interface-types" class="header-anchor">#</a> 3. Interface Types</h3> <p>When the injected Goner property is an interface type, it's termed as <strong>interface injection</strong>.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Seller <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag
    seller Seller <span class="token string">`gone:&quot;seller&quot;`</span> <span class="token comment">// interface type</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-slice-types"><a href="#_4-slice-types" class="header-anchor">#</a> 4. Slice Types</h3> <p>When the injected Goner property is a slice type, it's termed as <strong>slice injection</strong>. In slice injection, the element types of the slice can be value types, pointer types, or interface types. Due to the &quot;copy by pass&quot; nature of value types, it's not recommended to use them.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Seller <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag
    sellers <span class="token punctuation">[</span><span class="token punctuation">]</span>Seller  <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Slice type with elements as interface types</span>
    workers <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Worker <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Slice type with elements as pointer types</span>
    persons <span class="token punctuation">[</span><span class="token punctuation">]</span>Worker  <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Slice type with elements as value types (not recommended)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-map-types"><a href="#_5-map-types" class="header-anchor">#</a> 5. Map Types</h3> <p>When the injected Goner property is a map type, it's termed as <strong>map injection</strong>. In map injection, the element types of the map can be value types, pointer types, or interface types. Due to the &quot;copy by pass&quot; nature of value types, it's not recommended to use them. The keys of the map are always of type <code>string</code>, and the value of each key is the GonerId of the injected Goner.</p> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Seller <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Boss <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gone<span class="token punctuation">.</span>Flag
    sellers <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>Seller  <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Map type with values as interface types</span>
    workers <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>Worker <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Map type with values as pointer types</span>
    persons <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>Worker  <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Map type with values as value types (not recommended)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="pointer-injection-vs-interface-injection"><a href="#pointer-injection-vs-interface-injection" class="header-anchor">#</a> Pointer Injection vs Interface Injection</h2> <p>During the Bury process of a Goner in Gone, it's required to pass a reference. Both pointer injection and interface injection can pass the reference obtained from the <code>Cemetery.Bury</code> method to the properties of a structure. <strong>Pointer injection</strong> is simple and straightforward, with a one-to-one correspondence between types, requiring no further explanation. <strong>Interfaces</strong> in Go are designed to decouple business usage from business logic implementation, allowing the usage side to be unaware of the implementation details. Interfaces also help break circular dependencies, which are not allowed in Go due to its strong typing and compile-time checks. Here's how interfaces can be used to break circular dependencies between packages:</p> <p>Circular dependency:
<img src="data:image/png;base64,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" alt="Circular Dependency"></p> <p>Using interfaces to break the circular dependency:
<img src="/assets/img/image7.ca08b1e7.png" alt="Using Interfaces to Break Circular Dependency"></p> <p>Using interfaces helps hide implementation details, reduces coupling between modules, and adheres better to the &quot;open-closed&quot; principle. Therefore, <strong>interface injection</strong> is recommended. However, there are no absolute rules, and introducing interfaces will increase additional costs. Hence, we still support <strong>pointer injection</strong>.</p> <h2 id="slice-injection-vs-map-injection"><a href="#slice-injection-vs-map-injection" class="header-anchor">#</a> Slice Injection vs Map Injection</h2> <p>Gone supports injecting into <code>Slice</code> and <code>Map</code>, termed as <strong>slice injection</strong> and <strong>map injection</strong> respectively. In both cases, the elements of the Slice and Map can be value types, pointer types, or interface types. However, due to the &quot;copy by pass&quot; nature of value types, it's not recommended to use them. Here's how you can inject into Slice and Map properties:</p> <p><strong>Injection rules are as follows:</strong></p> <ul><li>Slice and Map can contain elements of Goner pointer types, Goner value types, or interfaces.</li> <li>Gone injects all compatible types of Goners into Slice and Map.</li> <li>Map keys are of type <code>string</code>, and the value of each key is the GonerId of the injected Goner. If no GonerId is specified during burial, Gone generates one.</li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Using value types as Slice and Map types is not recommended.</p></div> <p>Here's a complete example:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;github.com/gone-io/gone&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">type</span> AGoner <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>g <span class="token operator">*</span>AGoner<span class="token punctuation">)</span> <span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;I am the AGoner, My name is: %s&quot;</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> BGoner <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span>Flag
	aSlice1 <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>AGoner <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Slice type with elements as Goner pointer types</span>
	aSlice2 <span class="token punctuation">[</span><span class="token punctuation">]</span>AGoner  <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Slice type with elements as Goner value types</span>
	aMap1 <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>AGoner <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Map type with values as Goner pointer types</span>
	aMap2 <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>AGoner  <span class="token string">`gone:&quot;*&quot;`</span> <span class="token comment">// Map type with values as Goner value types</span>
<span class="token punctuation">}</span>
<span class="token comment">// AfterRevive executed After the Goner is revived; After `gone.Run`, gone framework detects the AfterRevive function on goners and runs it.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>g <span class="token operator">*</span>BGoner<span class="token punctuation">)</span> <span class="token function">AfterRevive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gone<span class="token punctuation">.</span>AfterReviveError <span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> a <span class="token operator">:=</span> <span class="token keyword">range</span> g<span class="token punctuation">.</span>aSlice1 <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;aSlice1:%s\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> a <span class="token operator">:=</span> <span class="token keyword">range</span> g<span class="token punctuation">.</span>aSlice2 <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;aSlice2:%s\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> k<span class="token punctuation">,</span> a <span class="token operator">:=</span> <span class="token keyword">range</span> g<span class="token punctuation">.</span>aMap1 <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;aMap1[%s]:%s\n&quot;</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> k<span class="token punctuation">,</span> a <span class="token operator">:=</span> <span class="token keyword">range</span> g<span class="token punctuation">.</span>aMap2 <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;aMap2[%s]:%s\n&quot;</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token comment">// NewA1 constructs A1 AGoner</span>
<span class="token keyword">func</span> <span class="token function">NewA1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>gone<span class="token punctuation">.</span>Goner<span class="token punctuation">,</span> gone<span class="token punctuation">.</span>GonerId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>AGoner<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Injected Goner1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;A1&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment">// NewA2 constructs A2 AGoner</span>
<span class="token keyword">func</span> <span class="token function">NewA2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>gone<span class="token punctuation">.</span>Goner<span class="token punctuation">,</span> gone<span class="token punctuation">.</span>GonerId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>AGoner<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Injected Goner2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;A2&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	gone<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>cemetery gone<span class="token punctuation">.</span>Cemetery<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
		cemetery<span class="token punctuation">.</span>
			<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token function">NewA1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
			<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AGoner<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;Anonymous&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
			<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token function">NewA2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
			<span class="token function">Bury</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>BGoner<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The example produces the following output:
<img src="/assets/img/image8.5d2d558a.png" alt="slice map injected example result"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/core-concept.html" class="prev">
        Core Concepts of Gone
      </a></span> <span class="next"><a href="/guide/inner-goner.html">
        How to Gracefully Use Built-in Goners?
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.adb83b8a.js" defer></script><script src="/assets/js/2.f18e2b4c.js" defer></script><script src="/assets/js/1.83b28654.js" defer></script><script src="/assets/js/19.06ac8f8c.js" defer></script>
  </body>
</html>
