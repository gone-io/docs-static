(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{333:function(t,e,n){"use strict";n.r(e);var s=n(10),a=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"http-注入说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-注入说明"}},[t._v("#")]),t._v(" http 注入说明")]),t._v(" "),e("h2",{attrs:{id:"http-依赖注入标签的格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-依赖注入标签的格式"}},[t._v("#")]),t._v(" http 依赖注入标签的格式")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('${attributeName} ${attributeType} gone:"http,${kind}=${key}"\n')])])]),e("p",[t._v("举例：")]),t._v(" "),e("div",{staticClass:"language-go extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[t._v("router"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/search"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("in "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    selects "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('`gone:"http,query=select"`')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注入值in.selects为`[]int{1,2,3}`")]),t._v("\n    fmt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%v"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" in"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selects"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("上面例子中，")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("selects")]),t._v("为属性名（attributeName）；")]),t._v(" "),e("li",[e("code",[t._v("[]int")]),t._v("为属性类型（attributeType）；")]),t._v(" "),e("li",[e("code",[t._v("query")]),t._v("为注入类型（kind）；")]),t._v(" "),e("li",[e("code",[t._v("select")]),t._v("为注入键值（key）。")])]),t._v(" "),e("h2",{attrs:{id:"支持注入的类型和响应标签"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#支持注入的类型和响应标签"}},[t._v("#")]),t._v(" 支持注入的类型和响应标签")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("名称")]),t._v(" "),e("th",[t._v("属性类型"),e("code",[t._v("${attributeType}")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("注入类型"),e("code",[t._v("${kind}")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("注入键值"),e("code",[t._v("${key}")])]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("上下文注入")])]),t._v(" "),e("td",[e("code",[t._v("gone.Context")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（不推荐）注入gin请求上下文对象，不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("上下文注入")])]),t._v(" "),e("td",[e("code",[t._v("*gone.Context")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（推荐）注入gin请求上下文指针，不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("请求注入")])]),t._v(" "),e("td",[e("code",[t._v("http.Request")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("不推荐）注入http.Request对象，不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("请求注入")])]),t._v(" "),e("td",[e("code",[t._v("*http.Request")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（推荐）注入http.Request指针，不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("地址注入")])]),t._v(" "),e("td",[e("code",[t._v("url.URL")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（不推荐）注入url.URL，不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("地址注入")])]),t._v(" "),e("td",[e("code",[t._v("*url.URL")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（推荐）注入url.URL指针，不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("请求头注入")])]),t._v(" "),e("td",[e("code",[t._v("http.Header")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（推荐）注入http.Header（请求头），不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("响应注入")])]),t._v(" "),e("td",[e("code",[t._v("gone.ResponseWriter")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("注入gin.ResponseWriter（用于直接写入响应数据），不需要类型"),e("code",[t._v("${kind}")]),t._v("和键值"),e("code",[t._v("${key}")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Body注入")])]),t._v(" "),e("td",[t._v("结构体、结构体指针")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("body")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("strong",[t._v("body注入")]),t._v("；将请求body解析后注入到属性，注入类型为 "),e("code",[t._v("body")]),t._v("，不需要“注入键值"),e("code",[t._v("${key}")]),t._v("”；框架根据"),e("code",[t._v("Content-Type")]),t._v("自动判定是json还是xml等格式；每个请求处理函数只允许存在一个"),e("strong",[t._v("body注入")]),t._v("。")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("请求头单值注入")])]),t._v(" "),e("td",[t._v("number | string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("header")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("缺省取字段名")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以键值"),e("code",[t._v("${key}")]),t._v("为"),e("code",[t._v("key")]),t._v("获取请求头，属性类型支持"),e("code",[t._v("string")]),t._v("和"),e("code",[t._v("int")]),t._v(","),e("code",[t._v("uint")]),t._v(","),e("code",[t._v("float64")]),t._v("等数字类型，解析不了会返回参数错误")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("URL参数注入")])]),t._v(" "),e("td",[t._v("number | string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("param")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("缺省取字段名")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以“注入键值"),e("code",[t._v("${key}")]),t._v("”为"),e("code",[t._v("key")]),t._v("调用函数"),e("code",[t._v("ctx.Param(key)")]),t._v("获取Url中定义的参数值，属性类型支持"),e("code",[t._v("string")]),t._v("和"),e("code",[t._v("int")]),t._v(","),e("code",[t._v("uint")]),t._v(","),e("code",[t._v("float64")]),t._v("等数字类型，解析不了会返回参数错误")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Query参数注入")])]),t._v(" "),e("td",[t._v("number | string | []number | []string | 结构体 | 结构体指针")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("query")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("缺省取字段名")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以“注入键值"),e("code",[t._v("${key}")]),t._v("”为"),e("code",[t._v("key")]),t._v("调用函数"),e("code",[t._v("ctx.Query(key)")]),t._v("获取Query中的参数，属性类型支持"),e("code",[t._v("string")]),t._v("和"),e("code",[t._v("int")]),t._v(","),e("code",[t._v("uint")]),t._v(","),e("code",[t._v("float64")]),t._v("等数字类型，"),e("strong",[t._v("支持数组"),e("sub",[t._v("[1]")])]),t._v("，解析不了会返回参数错误")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Cookie注入")])]),t._v(" "),e("td",[t._v("number | string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("cookie")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("缺省取字段名")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以“注入键值"),e("code",[t._v("${key}")]),t._v("”为"),e("code",[t._v("key")]),t._v("调用函数"),e("code",[t._v("ctx.Context.Cookie(key)")]),t._v("获取Cookie的值，属性类型支持"),e("code",[t._v("string")]),t._v("和"),e("code",[t._v("int")]),t._v(","),e("code",[t._v("uint")]),t._v(","),e("code",[t._v("float64")]),t._v("等数字类型，解析不了会返回参数错误")])])])]),t._v(" "),e("h2",{attrs:{id:"备注"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#备注"}},[t._v("#")]),t._v(" 备注")]),t._v(" "),e("p",[t._v("[1]. query参数注入支持数组，举例说明如下：\n如果请求的query为"),e("code",[t._v("?select=1&select=2&select=3")]),t._v("，下面代码中的 "),e("code",[t._v("in.selects")]),t._v(" 的值将会为 "),e("code",[t._v("[]int{1,2,3}")]),t._v("。")]),t._v(" "),e("div",{staticClass:"language-go extra-class"},[e("pre",{pre:!0,attrs:{class:"language-go"}},[e("code",[t._v("router"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/search"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("in "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    selects "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('`gone:"http,query=select"`')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注入值in.selects为`[]int{1,2,3}`")]),t._v("\n    fmt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%v"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" in"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selects"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);